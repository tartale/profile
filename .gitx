#!/bin/bash

git config --global user.email "tommygun731@gmail.com"
git config --global user.name "Tom"

export MYGITHUB="git@github.com:tartale"
export GITHUB="git@github.com:aspenmesh"

function gdefault() (
  defaultBranch="${GIT_DEFAULT_BRANCH:-main}"
  echo "${defaultBranch}"
)

function gsquash() (
  if [[ "${1}" == "" ]] || [[ "${2}" == "" ]]
  then
    echo "usage: gsquash <numCommits> <message>"
    return 1
  fi
  git reset --soft "HEAD~${1}" && git commit -vm "${2}"
)

function gclone {
  if [ -z $1 ]
  then
    echo "usage:  gclone <repository>"
    exit
  fi

  (cd $PROJECTS
    git clone $MYGITHUB/$1.git
    (
      cd $1
      git remote add upstream $GITHUB/$1.git
      git fetch upstream
    )
  )
}

function gfinish {
  if [ -z $1 ]
  then
    echo "usage:  gfinish <branch>"
    return
  fi
  branch="${1}"

  git checkout $(gdefault)
  git pull upstream $(gdefault)
  git branch -D ${branch}
}


THIS_SCRIPT_DIR=$(cd $(dirname $BASH_SOURCE); pwd)
source "${THIS_SCRIPT_DIR}/.git-completion.sh"

__git_complete gfinish _git_checkout
__git_complete gck _git_checkout
__git_complete gb _git_branch
